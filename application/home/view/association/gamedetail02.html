{extend name="public/common"}

{block name="style"}
<title>我要报名</title>
<link rel="stylesheet" href="/home/css/association/game.css">
<!--<link rel="stylesheet" href="/home/css/animate.min.css">-->
{/block}
{block name="body"}
    <div class="gameName">
        <p class="gameName01"><img src="/home/images/game/icon05.png" class="icon">赛事名称</p>
        <div class="gameName02">
            <p><span>{$data.title}</span><br><span>报名截止时间：{$data.end_time|time_format='Y-m-d'}</span></p>
            <p>{$data.address}</p>
        </div>
    </div>
    <div class="user">
        <p class="gameName01"><img src="/home/images/game/icon06.png" class="icon">人员信息</p>
        <div class="error"><img src="/home/images/game/icon10.png" class="gantan">部分信息无法获取，需要补充完善才可进行报名！</div>
        <div class="userSort active"><span>姓名</span><input type="text" placeholder="请填写" value="{$model.name}"  readonly="readonly"></div>
        <div class="userSort active"><span>出生日期</span><input type="text" placeholder="请填写" value="{$model.birthday}"  readonly="readonly"></div>
        <div class="userSort"><span>组别</span><input type="text" placeholder="请选择"  readonly="readonly" class="select" name="zb"><img src="/home/images/game/iconxl.png" class="xiala"></div>
        <div class="userSort"><span>剑种</span><input type="text" placeholder="请选择"  readonly="readonly" class="select" name="jz"><img src="/home/images/game/iconxl.png" class="xiala"></div>
        <div class="userSort active">
            <span>赛别</span>
            {eq name="$show_type" value="3"}
            <span style="font-size: .26rem;margin-left: .38rem;color: #ccc;">可多选</span>
            {/eq}
            <div class="gameSort">
                {eq name="$show_type" value="3"}
                <span class="active">• 个人</span>
                <span>• 团体</span>
                {else/}
                    {eq name="$show_type" value="2"}
                    <span class="active">• 团体</span>
                    {else/}
                    <span class="active">• 个人</span>
                    {/eq}
                {/eq}
            </div>
        </div>
        <div class="userSort active"><span>性别</span><input type="text" placeholder="请填写" value="{eq name='$model.gender' value='2'}女{else/}男{/eq}"  readonly="readonly"></div>
        <div class="userSort"><span>代表单位</span><input type="text" placeholder="请填写" value="{$representative}"></div>
        <div class="userSort"><span>带训教练</span><input type="text" placeholder="请填写" value="{$coach}"></div>
        <div class="userSort active"><span>监护人电话</span><input type="text" placeholder="请填写" value="{$model.guardian_mobile}"  readonly="readonly"></div>
        <div class="userSort"><span>证件类型</span><input type="text" placeholder="请选择"  readonly="readonly" class="select" name="zj"><img src="/home/images/game/iconxl.png" class="xiala"></div>
        <div class="userSort"><span>证件号</span><input type="text" placeholder="请填写" value="{$model.identity}"></div>
        <div class="userSort"><span>家庭住址</span><input type="text" placeholder="请填写" value="{$model.address}"></div>
        <div class="userSort"><span>备注</span><input type="text" placeholder="请填写" value=""></div>
    </div>
    {eq name="$model.vip" value="1"}
    <div class="pay">
        <div class="pay01"><img src="/home/images/game/icon07.png" class="icon">应付款</div>
        <div class="pay02">会员价：¥<span>400</span></div>
        <div class="pay03">普通价：¥<span>500</span></div>
    </div>
    <div class="vip">您已成为击剑馆会员，享受会员特权!</div>
    {else/}
    <div class="pay">
        <div class="pay01"><img src="/home/images/game/icon07.png" class="icon">应付款</div>
        <div class="pay02">普通价：¥<span>500</span></div>
        <div class="pay03">会员价：¥<span>400</span></div>
    </div>
<div class="vip"><a href="{:Url('User/insider')}">加入击剑馆会员，享受会员特权!</a></div>
    {/eq}
    <div class="goPay" data-type="1">去付款</div>
<div id="HBox">
    <div class="HBoxSorts">
    </div>
</div>

<div id="pay">
    <div class="payError">
        <div class="payError01"><img src="/home/images/game/icon08.png" alt=""></div>
        <div class="payError02">
            <p>请继续完善所有信息</p>
            <p>才可进行报名付款！</p>
        </div>
        <div class="payError03">继续填写</div>
    </div>
</div>
{/block}
{block name="script"}
<script src="/home/js/jquery.hdialog.min.js"></script>
<script>
    $('.select').on('click',function(){
        $('#HBox').show();
        var _height = $('.HBoxSorts').height();
        $('.HBoxSorts').stop().animate({
            bottom:'0'
        },500);
        var name = $(this)[0].name;
        _select(name)
    })
    $(document).on('click','.HBoxSorts p',function(){
        var sort = localStorage.getItem('_name');
        if(sort == 'zb'){
            $('input[name=zb]').val($(this).text())
        }else if(sort == 'jz'){
            $('input[name=jz]').val($(this).text())
        }else if(sort == 'zj'){
            $('input[name=zj]').val($(this).text())
        }
        $('.HBoxSorts').stop().animate({
            bottom:'-100%'
        },500);
        setTimeout(function(){$('#HBox').hide();},500);
    })
    function bodyScroll(event){
        event.preventDefault();
    }

    function _select(name){
        var str = '';
        if(name == 'zb'){
            $.ajax({
                type: "post",
                url: "{:Url('Association/getgrouplist')}",
                data: {id:'1'},
                dataType: "json",
                success: function (data) {
                    console.log(data)
                }
            })
            str += '<p>幼儿组</p><p>幼儿组1</p><p>幼儿组2</p><p>幼儿组3</p><p>幼儿组4</p><p>幼儿组5</p>'
        }else if(name == 'jz'){
            $.ajax({
                type: "post",
                url: "{:Url('Association/getkindslist')}",
                data: '',
                dataType: "json",
                success: function (data) {
                    var data = JSON.parse(data);
                    for(var i=0;i<data;i++){
                        console.log(data[i])
                    }

                }
            })
        }else if(name == 'zj'){
            str += '<p>身份证</p><p>军人</p><p>港澳台</p>'
        }
        localStorage.setItem('_name',name)
        $('.HBoxSorts').html(str)
    }
    if($('.goPay').data('type')!==1){
        $('.goPay').css('background','#C2C2C2')
    }
    $('.goPay').on('click',function(){
        if($(this).data('type')==1){
            location.href='/home/association/paysuccess.html'
        }else{
            $('#pay').show();
            $('body').css('position','fixed');
        }
    })
    $('.payError03').on('click',function(){
        $('#pay').hide();
        $('body').css('position','inherit');
    })

</script>
{/block}